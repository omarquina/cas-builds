# !/bin/sh

# Archivo que sobreescribiría el assemble del imagebuilder para s2i
# es una opción para poder compilar todos el código fuente de todos los proyectos CAS, 
# para ser agregados a Tomcat
echo "Iniciando Custom assemble"

echo "CATALINA: ${CATALINA_HOME}"
DEPLOY_DIR=$CATALINA_HOME/webapps

echo "Listando Directorio actual: `pwd`"
echo "`ls`"
echo "Voy a clonar cas_consumes_json"
git clone http://git.cautivatech.com/gomix/cas_consumes_json.git
#echo "Listando luego de clonar `ls .`"
echo "--"
ls *
# clean webapps
rm -rf $DEPLOY_DIR/*
pushd . &> /dev/null
pushd cas_consumes_json/ConsumesJSON
ls
mvn package -DskipTests -s $HOME/.m2/settings.xml
find -name *.war*
mv `find -name *.war*` $DEPLOY_DIR/
echo "LISTANDO DEPLOY_DIR"
ls $DEPLOY_DIR/

